module.exports=[82935,a=>{"use strict";var b=a.i(87924),c=a.i(50944),d=a.i(53427);a.i(69387);var e=a.i(60574),f=a.i(3130),g=a.i(40695),h=a.i(5522),i=a.i(72131),j=a.i(70121),k=a.i(50104),l=a.i(7554),m=a.i(25152),n=a.i(77994),o=a.i(3688),p=a.i(77192),q=a.i(30553),r="Checkbox",[s,t]=(0,k.createContextScope)(r),[u,v]=s(r);function w(a){let{__scopeCheckbox:c,checked:d,children:e,defaultChecked:f,disabled:g,form:h,name:j,onCheckedChange:k,required:l,value:n="on",internal_do_not_use_render:o}=a,[p,q]=(0,m.useControllableState)({prop:d,defaultProp:f??!1,onChange:k,caller:r}),[s,t]=i.useState(null),[v,w]=i.useState(null),x=i.useRef(!1),y=!s||!!h||!!s.closest("form"),z={checked:p,disabled:g,setChecked:q,control:s,setControl:t,name:j,form:h,value:n,hasConsumerStoppedPropagationRef:x,required:l,defaultChecked:!E(f)&&f,isFormControl:y,bubbleInput:v,setBubbleInput:w};return(0,b.jsx)(u,{scope:c,...z,children:"function"==typeof o?o(z):e})}var x="CheckboxTrigger",y=i.forwardRef(({__scopeCheckbox:a,onKeyDown:c,onClick:d,...e},f)=>{let{control:g,value:h,disabled:k,checked:m,required:n,setControl:o,setChecked:p,hasConsumerStoppedPropagationRef:r,isFormControl:s,bubbleInput:t}=v(x,a),u=(0,j.useComposedRefs)(f,o),w=i.useRef(m);return i.useEffect(()=>{let a=g?.form;if(a){let b=()=>p(w.current);return a.addEventListener("reset",b),()=>a.removeEventListener("reset",b)}},[g,p]),(0,b.jsx)(q.Primitive.button,{type:"button",role:"checkbox","aria-checked":E(m)?"mixed":m,"aria-required":n,"data-state":F(m),"data-disabled":k?"":void 0,disabled:k,value:h,...e,ref:u,onKeyDown:(0,l.composeEventHandlers)(c,a=>{"Enter"===a.key&&a.preventDefault()}),onClick:(0,l.composeEventHandlers)(d,a=>{p(a=>!!E(a)||!a),t&&s&&(r.current=a.isPropagationStopped(),r.current||a.stopPropagation())})})});y.displayName=x;var z=i.forwardRef((a,c)=>{let{__scopeCheckbox:d,name:e,checked:f,defaultChecked:g,required:h,disabled:i,value:j,onCheckedChange:k,form:l,...m}=a;return(0,b.jsx)(w,{__scopeCheckbox:d,checked:f,defaultChecked:g,disabled:i,required:h,onCheckedChange:k,name:e,form:l,value:j,internal_do_not_use_render:({isFormControl:a})=>(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(y,{...m,ref:c,__scopeCheckbox:d}),a&&(0,b.jsx)(D,{__scopeCheckbox:d})]})})});z.displayName=r;var A="CheckboxIndicator",B=i.forwardRef((a,c)=>{let{__scopeCheckbox:d,forceMount:e,...f}=a,g=v(A,d);return(0,b.jsx)(p.Presence,{present:e||E(g.checked)||!0===g.checked,children:(0,b.jsx)(q.Primitive.span,{"data-state":F(g.checked),"data-disabled":g.disabled?"":void 0,...f,ref:c,style:{pointerEvents:"none",...a.style}})})});B.displayName=A;var C="CheckboxBubbleInput",D=i.forwardRef(({__scopeCheckbox:a,...c},d)=>{let{control:e,hasConsumerStoppedPropagationRef:f,checked:g,defaultChecked:h,required:k,disabled:l,name:m,value:p,form:r,bubbleInput:s,setBubbleInput:t}=v(C,a),u=(0,j.useComposedRefs)(d,t),w=(0,n.usePrevious)(g),x=(0,o.useSize)(e);i.useEffect(()=>{if(!s)return;let a=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set,b=!f.current;if(w!==g&&a){let c=new Event("click",{bubbles:b});s.indeterminate=E(g),a.call(s,!E(g)&&g),s.dispatchEvent(c)}},[s,w,g,f]);let y=i.useRef(!E(g)&&g);return(0,b.jsx)(q.Primitive.input,{type:"checkbox","aria-hidden":!0,defaultChecked:h??y.current,required:k,disabled:l,name:m,value:p,form:r,...c,tabIndex:-1,ref:u,style:{...c.style,...x,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function E(a){return"indeterminate"===a}function F(a){return E(a)?"indeterminate":a?"checked":"unchecked"}D.displayName=C;var G=a.i(33441),H=a.i(97895);let I=i.forwardRef(({className:a,...c},d)=>(0,b.jsx)(z,{ref:d,className:(0,H.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...c,children:(0,b.jsx)(B,{className:(0,H.cn)("flex items-center justify-center text-current"),children:(0,b.jsx)(G.Check,{className:"h-4 w-4"})})}));I.displayName=z.displayName;var J=a.i(30330),K=a.i(30342),L=a.i(87682),M=a.i(95245),N=a.i(59501),O=a.i(99614),P=a.i(58213),Q=a.i(67937),Q=Q,R=a.i(210),S=a.i(72228),T=a.i(77687),U=a.i(38246),V=a.i(50463);let W=O.object({assignTo:O.enum(["class","students","self"]),classId:O.string().optional(),studentIds:O.array(O.string()).optional(),startDate:O.date().optional(),dueDate:O.date().optional(),allowLateSubmission:O.boolean().default(!1),shuffleQuestions:O.boolean().default(!0),maxAttempts:O.coerce.number().min(1).max(10).optional(),timeLimit:O.coerce.number().min(5).max(300).optional()});function X(){let a=(0,c.useParams)(),j=(0,c.useRouter)(),k=a.quizId,{user:l}=(0,d.useUser)(),m=(0,d.useFirestore)(),[n,o]=(0,i.useState)(!1),p=(0,d.useMemoFirebase)(()=>m&&k?(0,e.doc)(m,"quizzes",k):null,[m,k]),{data:q,isLoading:r}=(0,d.useDoc)(p),s=(0,d.useMemoFirebase)(()=>l&&m?(0,e.query)((0,e.collection)(m,"classes"),(0,e.where)("createdBy","==",l.uid)):null,[l,m]),{data:t}=(0,d.useCollection)(s),u=(0,M.useForm)({resolver:(0,N.zodResolver)(W),defaultValues:{assignTo:"class",allowLateSubmission:!1,shuffleQuestions:!0,maxAttempts:1}}),v=u.watch("assignTo"),w=async a=>{if(!l||!m||!q)return void(0,T.toast)({variant:"destructive",title:"Error",description:"Missing required information."});o(!0);try{let b={quizId:q.id,assignedBy:l.uid,assignedAt:new Date().toISOString(),startDate:a.startDate?.toISOString(),dueDate:a.dueDate?.toISOString(),allowLateSubmission:a.allowLateSubmission||!1,shuffleQuestions:a.shuffleQuestions??!0,maxAttempts:a.maxAttempts||1,timeLimit:a.timeLimit,status:a.startDate&&new Date(a.startDate)>new Date?"scheduled":"active"};"class"===a.assignTo&&a.classId?(b.classId=a.classId,await (0,e.updateDoc)((0,e.doc)(m,"classes",a.classId),{assignedQuizIds:(0,e.arrayUnion)(q.id)})):"students"===a.assignTo&&a.studentIds&&(b.studentIds=a.studentIds),await (0,e.addDoc)((0,e.collection)(m,"quizAssignments"),b);let c={quizId:q.id,quizTitle:q.title,scheduledTime:a.startDate?.toISOString()||new Date().toISOString(),status:"Scheduled",accessCode:function(){let a="ABCDEFGHJKLMNPQRSTUVWXYZ23456789",b="";for(let c=0;c<6;c++)b+=a.charAt(Math.floor(Math.random()*a.length));return b}(),createdBy:l.uid,createdAt:new Date().toISOString(),enrolledStudentIds:"class"===a.assignTo&&a.classId?t?.find(b=>b.id===a.classId)?.enrolledStudentIds||[]:a.studentIds||[]};await (0,e.addDoc)((0,e.collection)(m,"exams"),c),(0,T.toast)({title:"Quiz Assigned!",description:`Quiz has been assigned successfully. Access code: ${c.accessCode}`}),j.push(`/dashboard/quizzes/${q.id}/analytics`)}catch(a){(0,T.toast)({variant:"destructive",title:"Error",description:a.message||"Failed to assign quiz."})}finally{o(!1)}};return r?(0,b.jsxs)("div",{className:"p-8",children:[(0,b.jsx)(V.Skeleton,{className:"h-10 w-48 mb-8"}),(0,b.jsx)(V.Skeleton,{className:"h-64 w-full"})]}):q?(0,b.jsxs)("div",{className:"p-4 md:p-8 max-w-3xl mx-auto space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(g.Button,{variant:"ghost",asChild:!0,children:(0,b.jsxs)(U.default,{href:"/dashboard/quizzes",children:[(0,b.jsx)(R.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Back"]})}),(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Assign Quiz"})]}),(0,b.jsxs)(f.Card,{children:[(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsx)(f.CardTitle,{children:q.title}),(0,b.jsx)(f.CardDescription,{children:"Configure assignment settings and assign to students or classes"})]}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)(P.Form,{...u,children:(0,b.jsxs)("form",{onSubmit:u.handleSubmit(w),className:"space-y-6",children:[(0,b.jsx)(P.FormField,{control:u.control,name:"assignTo",render:({field:a})=>(0,b.jsxs)(P.FormItem,{children:[(0,b.jsx)(P.FormLabel,{children:"Assign To"}),(0,b.jsxs)(L.Select,{onValueChange:a.onChange,defaultValue:a.value,children:[(0,b.jsx)(P.FormControl,{children:(0,b.jsx)(L.SelectTrigger,{children:(0,b.jsx)(L.SelectValue,{})})}),(0,b.jsxs)(L.SelectContent,{children:[(0,b.jsx)(L.SelectItem,{value:"class",children:"Entire Class"}),(0,b.jsx)(L.SelectItem,{value:"students",children:"Selected Students"}),(0,b.jsx)(L.SelectItem,{value:"self",children:"Self-Practice (No Grading)"})]})]}),(0,b.jsx)(P.FormMessage,{})]})}),"class"===v&&(0,b.jsx)(P.FormField,{control:u.control,name:"classId",render:({field:a})=>(0,b.jsxs)(P.FormItem,{children:[(0,b.jsx)(P.FormLabel,{children:"Select Class"}),(0,b.jsxs)(L.Select,{onValueChange:a.onChange,children:[(0,b.jsx)(P.FormControl,{children:(0,b.jsx)(L.SelectTrigger,{children:(0,b.jsx)(L.SelectValue,{placeholder:"Choose a class"})})}),(0,b.jsx)(L.SelectContent,{children:t?.map(a=>(0,b.jsxs)(L.SelectItem,{value:a.id,children:[a.name," (",a.enrolledStudentIds.length," students)"]},a.id))})]}),(0,b.jsx)(P.FormMessage,{})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsx)(P.FormField,{control:u.control,name:"startDate",render:({field:a})=>(0,b.jsxs)(P.FormItem,{children:[(0,b.jsx)(P.FormLabel,{children:"Start Date (Optional)"}),(0,b.jsxs)(K.Popover,{children:[(0,b.jsx)(K.PopoverTrigger,{asChild:!0,children:(0,b.jsx)(P.FormControl,{children:(0,b.jsxs)(g.Button,{variant:"outline",className:(0,H.cn)("w-full pl-3 text-left font-normal",!a.value&&"text-muted-foreground"),children:[a.value?(0,S.format)(a.value,"PPP"):(0,b.jsx)("span",{children:"Pick a date"}),(0,b.jsx)(Q.default,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),(0,b.jsx)(K.PopoverContent,{className:"w-auto p-0",align:"start",children:(0,b.jsx)(J.Calendar,{mode:"single",selected:a.value,onSelect:a.onChange,initialFocus:!0})})]}),(0,b.jsx)(P.FormMessage,{})]})}),(0,b.jsx)(P.FormField,{control:u.control,name:"dueDate",render:({field:a})=>(0,b.jsxs)(P.FormItem,{children:[(0,b.jsx)(P.FormLabel,{children:"Due Date (Optional)"}),(0,b.jsxs)(K.Popover,{children:[(0,b.jsx)(K.PopoverTrigger,{asChild:!0,children:(0,b.jsx)(P.FormControl,{children:(0,b.jsxs)(g.Button,{variant:"outline",className:(0,H.cn)("w-full pl-3 text-left font-normal",!a.value&&"text-muted-foreground"),children:[a.value?(0,S.format)(a.value,"PPP"):(0,b.jsx)("span",{children:"Pick a date"}),(0,b.jsx)(Q.default,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),(0,b.jsx)(K.PopoverContent,{className:"w-auto p-0",align:"start",children:(0,b.jsx)(J.Calendar,{mode:"single",selected:a.value,onSelect:a.onChange,initialFocus:!0})})]}),(0,b.jsx)(P.FormMessage,{})]})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsx)(P.FormField,{control:u.control,name:"maxAttempts",render:({field:a})=>(0,b.jsxs)(P.FormItem,{children:[(0,b.jsx)(P.FormLabel,{children:"Max Attempts"}),(0,b.jsx)(P.FormControl,{children:(0,b.jsx)(h.Input,{type:"number",min:1,max:10,...a})}),(0,b.jsx)(P.FormMessage,{})]})}),(0,b.jsx)(P.FormField,{control:u.control,name:"timeLimit",render:({field:a})=>(0,b.jsxs)(P.FormItem,{children:[(0,b.jsx)(P.FormLabel,{children:"Time Limit (minutes)"}),(0,b.jsx)(P.FormControl,{children:(0,b.jsx)(h.Input,{type:"number",min:5,max:300,...a})}),(0,b.jsx)(P.FormMessage,{})]})})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(P.FormField,{control:u.control,name:"shuffleQuestions",render:({field:a})=>(0,b.jsxs)(P.FormItem,{className:"flex flex-row items-start space-x-3 space-y-0",children:[(0,b.jsx)(P.FormControl,{children:(0,b.jsx)(I,{checked:a.value,onCheckedChange:a.onChange})}),(0,b.jsx)("div",{className:"space-y-1 leading-none",children:(0,b.jsx)(P.FormLabel,{children:"Shuffle Questions"})})]})}),(0,b.jsx)(P.FormField,{control:u.control,name:"allowLateSubmission",render:({field:a})=>(0,b.jsxs)(P.FormItem,{className:"flex flex-row items-start space-x-3 space-y-0",children:[(0,b.jsx)(P.FormControl,{children:(0,b.jsx)(I,{checked:a.value,onCheckedChange:a.onChange})}),(0,b.jsx)("div",{className:"space-y-1 leading-none",children:(0,b.jsx)(P.FormLabel,{children:"Allow Late Submission"})})]})})]}),(0,b.jsx)(g.Button,{type:"submit",className:"w-full",disabled:n,children:n?"Assigning...":"Assign Quiz"})]})})})]})]}):(0,b.jsxs)("div",{className:"p-8 text-center",children:[(0,b.jsx)("p",{className:"text-destructive",children:"Quiz not found."}),(0,b.jsx)(g.Button,{onClick:()=>j.push("/dashboard"),className:"mt-4",children:"Back to Dashboard"})]})}a.s(["default",()=>X],82935)}];

//# sourceMappingURL=app_dashboard_quizzes_%5BquizId%5D_assign_page_tsx_af83ec24._.js.map